<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Devotional Calendar – Dwelling in Christ</title>
<link href="https://fonts.googleapis.com/css2?family=Kalam:wght@300;400;700&display=swap" rel="stylesheet">

<style>
:root {
  --matcha-light: #d4edda;
  --matcha-vibrant: #a8d5ba;
  --matcha-deep: #4a7c59;
  --tea-white: #f8f9fa;
  --organic-shadow: rgba(74, 124, 89, 0.2);
  --matcha-gradient: linear-gradient(135deg, var(--matcha-light), var(--matcha-vibrant), var(--tea-white));
  --tomato-blush-gradient: linear-gradient(to bottom, #ffb6c1, #dc143c); /* Richer tomato blush */
}

body {
  margin: 0;
  font-family: 'Kalam', cursive; /* Cute Asian handwriting font */
  background-image: radial-gradient(circle at 30% 70%, rgba(168, 213, 186, 0.3) 0%, transparent 50%),
                    radial-gradient(circle at 70% 30%, rgba(212, 237, 218, 0.3) 0%, transparent 50%),
                    var(--tomato-blush-gradient); /* Layered: patterns on top of gradient */
  background-size: cover;
  color: var(--matcha-deep);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  max-width: 950px;
  width: 95%;
  padding: 2rem;
  border-radius: 15px; /* Soft corners */
  background: var(--tea-white);
  box-shadow: 0 4px 12px var(--organic-shadow);
}

header {
  text-align: center;
  margin-bottom: 1.5rem;
}

header h1 {
  font-size: 2.6rem;
  background: var(--matcha-gradient);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  /* Removed text-shadow for crisp edges */
  font-weight: 700;
}

header small {
  display: block;
  color: var(--matcha-vibrant);
  margin-top: 0.3rem;
  font-size: 1rem;
}

.name-input {
  background: var(--tea-white);
  border: 2px solid var(--matcha-vibrant);
  border-radius: 10px; /* Soft corners */
  color: var(--matcha-deep);
  text-align: center;
  margin-top: 0.5rem;
  font-size: 1rem;
  outline: none;
  padding: 0.5rem;
  box-shadow: 0 2px 4px var(--organic-shadow);
}

.confirmation {
  margin-top: 0.5rem;
  font-size: 0.9rem;
  color: var(--matcha-vibrant);
  font-style: italic;
  opacity: 0;
  transition: opacity 0.8s ease;
  background: var(--matcha-light);
  padding: 0.2rem 0.5rem;
  border-radius: 10px; /* Soft corners */
  display: inline-block;
}

.confirmation.show {
  opacity: 1;
}

.month-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 1.4rem 0;
}

.month-bar button {
  border-radius: 10px; /* Soft corners */
  border: 2px solid var(--matcha-vibrant);
  background: var(--tea-white);
  color: var(--matcha-deep);
  padding: 0.5rem 1rem;
  cursor: pointer;
  font-weight: 400;
  transition: transform 0.2s ease;
}

.month-bar button:hover {
  transform: scale(1.05);
}

.month-title {
  font-size: 1.2rem;
  color: var(--matcha-vibrant);
  font-weight: 700;
}

.calendar {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 0.8rem;
}

.day {
  background: linear-gradient(135deg, var(--tea-white), var(--matcha-light));
  border-radius: 10px; /* Soft corners on squares */
  padding: 0.7rem;
  min-height: 80px;
  border: 2px solid var(--matcha-vibrant);
  opacity: 0.7;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  box-shadow: 0 2px 6px var(--organic-shadow);
  transition: opacity 0.3s ease, transform 0.3s ease;
}

.day.unlocked {
  cursor: pointer;
  opacity: 0.9;
}

.day.unlocked:hover {
  opacity: 1;
  transform: scale(1.05);
}

.day.today {
  opacity: 1;
  animation: organicGlow 6s ease-in-out infinite;
  border-color: var(--matcha-deep);
}

@keyframes organicGlow {
  0%,100% { box-shadow: 0 0 8px rgba(168, 213, 186, 0.5); }
  50% { box-shadow: 0 0 16px rgba(168, 213, 186, 0.7); }
}

.day-number {
  color: var(--matcha-deep);
  font-size: 1rem;
  font-weight: 700;
}

.lock {
  position: absolute;
  bottom: 6px;
  right: 8px;
  font-size: 0.7rem;
  color: var(--matcha-vibrant);
}

.message-box {
  margin-top: 1.5rem;
  background: linear-gradient(145deg, var(--tea-white), var(--matcha-light));
  border-radius: 15px; /* Soft corners */
  padding: 1.5rem;
  border: 2px solid var(--matcha-vibrant);
  box-shadow: 0 4px 12px var(--organic-shadow);
}

.message-box h3 {
  color: var(--matcha-deep);
  font-weight: 700;
}

.scripture {
  font-style: italic;
  color: var(--matcha-deep);
  margin-top: 0.6rem;
}

.prayer-btn {
  margin-top: 1rem;
  background: linear-gradient(135deg, var(--matcha-vibrant), var(--matcha-deep));
  color: var(--tea-white);
  border: none;
  padding: 0.6rem 1.5rem;
  border-radius: 10px; /* Soft corners */
  cursor: pointer;
  font-family: inherit;
  font-weight: 400;
  box-shadow: 0 2px 4px var(--organic-shadow);
  transition: transform 0.2s ease;
}

.prayer-btn:hover {
  transform: scale(1.05);
}

.prayer {
  margin-top: 0.7rem;
  color: var(--matcha-deep);
  display: none;
}
</style>
</head>

<body>
<div class="container">

<header>
  <h1 id="calendarTitle">Devotional Calendar</h1>
  <small>What do you want to be called?</small>
  <input id="nameInput" class="name-input" placeholder="Beloved of God">
  <div id="confirmation" class="confirmation"></div>
</header>

<div class="month-bar">
  <button onclick="changeMonth(-1)">‹</button>
  <div class="month-title" id="monthTitle"></div>
  <button onclick="changeMonth(1)">›</button>
</div>

<div class="calendar" id="calendar"></div>

<div class="message-box" id="messageBox">
  <h3 id="messageTitle">Welcome</h3>
  <p id="messageText">Select today’s date to receive what the Lord has prepared.</p>
  <div class="scripture" id="scriptureText"></div>
  <button class="prayer-btn" onclick="togglePrayer()">Daily Prayer</button>
  <div class="prayer" id="prayerText"></div>
</div>

</div>

<script>
const today = new Date();

const devotionals = Array.from({length:31},(_,i)=>({
  message: [
    "Rest in Me. Healing begins when striving ends.",
    "Abide in Me; closeness is where strength grows.",
    "I am gently restoring your heart.",
    "You are safe in My presence.",
    "Let My peace settle you today.",
    "Remain with Me and be renewed.",
    "I am near to the brokenhearted.",
    "You are being made whole.",
    "My grace is sufficient for you.",
    "Stay with Me; I delight in you.",
    "You are not alone.",
    "I am your refuge.",
    "Trust Me with your wounds.",
    "Healing flows from My love.",
    "I am shaping beauty in you.",
    "Be still and know Me.",
    "Your heart is precious to Me.",
    "I am patient with your growth.",
    "Remain rooted in truth.",
    "I am your peace.",
    "Let grace lead you.",
    "You are deeply known.",
    "I am faithful.",
    "Your healing matters.",
    "Come dwell with Me.",
    "My love covers you.",
    "You are cherished.",
    "I walk with you.",
    "My light surrounds you.",
    "Rest in My care.",
    "Abide and flourish."
  ][i],
  verse: [
    "Psalm 46:10","John 15:4","Psalm 147:3","Isaiah 41:10",
    "John 14:27","Isaiah 40:31","Psalm 34:18","2 Corinthians 5:17",
    "2 Corinthians 12:9","Zephaniah 3:17","Deuteronomy 31:6",
    "Psalm 91:2","Matthew 11:28","1 John 4:16","Romans 8:28",
    "Psalm 46:10","Luke 12:6","Philippians 1:6","Colossians 2:7",
    "John 16:33","Ephesians 2:8","Psalm 139:1","Lamentations 3:22",
    "Jeremiah 30:17","Psalm 27:4","Romans 5:8","Isaiah 43:4",
    "Micah 6:8","John 1:5","Psalm 4:8","John 15:5"
  ][i],
  prayer: "Lord Jesus, I choose to dwell in You today. Heal what is tender, strengthen what is weak, and draw me ever closer to Your heart. Amen."
}));

let month = today.getMonth();
let year = today.getFullYear();

const calendar = document.getElementById("calendar");
const monthTitle = document.getElementById("monthTitle");
const nameInput = document.getElementById('nameInput');
const calendarTitle = document.getElementById('calendarTitle');
const confirmation = document.getElementById('confirmation');
const messageBox = document.getElementById('messageBox');

function updateTitle() {
  const name = nameInput.value.trim();
  if (name) {
    calendarTitle.textContent = `${name}'s Devotional Calendar`;
  } else {
    calendarTitle.textContent = 'Devotional Calendar';
  }
  localStorage.setItem('userName', name);
}

function showConfirmation() {
  const name = nameInput.value.trim();
  if (name) {
    confirmation.textContent = `Welcome, ${name}! May you dwell in Christ today.`;
    confirmation.classList.add('show');
    setTimeout(() => {
      confirmation.classList.remove('show');
    }, 3000); // Hide after 3 seconds
  }
}

nameInput.addEventListener('input', updateTitle);
nameInput.addEventListener('keydown', (event) => {
  if (event.key === 'Enter') {
    showConfirmation();
  }
});
nameInput.addEventListener('blur', showConfirmation); // Also on blur for completeness

// Load saved name on page load
const savedName = localStorage.getItem('userName');
if (savedName) {
  nameInput.value = savedName;
  updateTitle();
}

function renderCalendar() {
  calendar.innerHTML = "";
  const firstDay = new Date(year, month, 1).getDay();
  const daysInMonth = new Date(year, month + 1, 0).getDate();

  monthTitle.textContent = new Date(year, month)
    .toLocaleString("default",{month:"long",year:"numeric"});

  for(let i=0;i<firstDay;i++) calendar.appendChild(document.createElement("div"));

  for(let d=1;d<=daysInMonth;d++){
    const cell = document.createElement("div");
    const cellDate = new Date(year,month,d);
    const unlocked = cellDate <= today;

    cell.className = "day" + (unlocked ? " unlocked" : "");
    if(d===today.getDate() && month===today.getMonth() && year===today.getFullYear())
      cell.classList.add("today");

    cell.innerHTML = `<div class="day-number">${d}</div>` +
      (unlocked ? "" : `<div class="lock">locked</div>`);

    if(unlocked){
      cell.onclick = ()=>selectDay(d);
    }
    calendar.appendChild(cell);
  }
}

function selectDay(day){
  playF(day);
  const data = devotionals[day-1];
  const name = nameInput.value.trim() || 'Beloved';
  document.getElementById("messageTitle").textContent = `Day ${day}`;
  document.getElementById("messageText").textContent = `${name}, ${data.message}`;
  document.getElementById("scriptureText").textContent = data.verse;
  document.getElementById("prayerText").textContent = data.prayer;
  document.getElementById("prayerText").style.display = "none";
  
  // Smooth scroll to the message box
  messageBox.scrollIntoView({ behavior: 'smooth' });
}

function togglePrayer(){
  const p = document.getElementById("prayerText");
  p.style.display = p.style.display==="block"?"none":"block";
}

function changeMonth(n){
  month += n;
  if(month<0){month=11;year--;}
  if(month>11){month=0;year++;}
  renderCalendar();
}

function playF(day = 1){
  const ctx = new (window.AudioContext || window.webkitAudioContext)();

  // Full gentle F-major palette
  const scale = [
    349.23, // F
    440.00, // A
    523.25, // C
    587.33, // D
    466.16  // Bb
  ];

  // Determine how many notes are allowed today
  const noteCount = Math.min(2 + Math.floor(day / 6), scale.length);
  const melody = scale.slice(0, noteCount);

  const now = ctx.currentTime;

  melody.forEach((freq, i) => {
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = "sine";
    osc.frequency.value = freq;

    const start = now + i * 0.55;

    gain.gain.setValueAtTime(0.0001, start);
    gain.gain.exponentialRampToValueAtTime(0.035, start + 0.2);
    gain.gain.exponentialRampToValueAtTime(0.0001, start + 1.0);

    osc.connect(gain);
    gain.connect(ctx.destination);

    osc.start(start);
    osc.stop(start + 1.2);
  });
}

renderCalendar();
</script>
</body>
</html>
